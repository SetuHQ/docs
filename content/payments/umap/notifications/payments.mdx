---
sidebar_title: Payments
page_title: UMAP - Notifications and alerts - Payments
order: 1
visible_in_sidebar: true
---

## Notifications and alerts for payments

Any UMAP product relies on creating and presenting payment request to a customer. Setu’s UMAP stack provides consistent and transparent payment statuses for a merchant, to be able to track the life-cycle of a payment request. These statuses are shown in the diagram below.
<img
  src="https://storage.googleapis.com/strapi-assets/latest/Frame_72/Frame_72.png"
  alt="Bridge"
/>

| **Payment statuses** | **Description**                                               |
| -------------------------------- | ------------------------------------------------- |
| `payment.initiated`              | Payment has been attempted by a customer          |
| `payment.ending`                 | Payment is currently being processed by UMAP      |
| `payment.success`                | Payment has been successfully completed           |
| `payment.failed`                 | Payment could not be processed                    |


<Callout type="warning">
    The order of the payment notifications cannot be guaranteed. For example, a client might receive a <code>payment.success</code> notification before a <code>payment.initiated</code> is sent.
</Callout>


### Details for each payment status

<Text><code>Sqr</code>, <code>Dqr</code>, <code>Tpv</code> and <code>Autopay</code> - all of these products raise payment events when a customer interacts with the QR code/ intent link generated by Setu and tries to make a payment. 
The payment notification tries to capture all the relevant information about the payment and the product on which the payment was made.</Text>

<Callout type="tip">
    There are some nuances to the notification spec based on the product used.
</Callout>

For TPV, these are the additional attributes in the notification spec -
<CodeBlockWithCopy language="json">
{`{
   // Payment context
   "productInstanceType": "pay_single_tpv",
   //  TPV attributes
   “tpv”: {
      "sourceAccounts": [
         {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 1234",
            "accountName": "M*N* T*O*M*A*S",
         }
      ],
      "customerAccount": {
         "ifsc": "HDFC00123",
         "accountNumber": "**** **** **** 1234",
         "accountName": "M*N* T*O*M*A*S",
      }
   }
}`}
</CodeBlockWithCopy>

<Tabs
   tabs={[
         {
            key: "1",
            label: "Payment initiated",
            content: (
               <>
                  <Text>This indicates that a payment has been initiated by a customer, and the notification is only then sent to the merchant.</Text>
                  <CodeBlockWithCopy language="json">
{`{
   // Resource
   "resource": "payment",
   "status": "initiated",
   // Event attributes
   "eventId": "01ARZ3NDEKTSV4RRFFQ69G5FAV", // Id of an event (unique for each event)
   "eventTs": "2023-09-04 12:08:20.202644 +0530 IST", // Timestamp associated with the event
   "eventType": "payment.initiated",
   // Payment context
   "productInstanceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "productInstanceType": "<TYPE>", // collect | pay_single | pay_multi | pay_single_tpv | autopay
   "merchantReferenceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   // References
   "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   // Payment attributes
   "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "txnId": "SETmBZkQOV0M7wyyP1V4PIFhRSzW5eSjmYI",
   "txnType": "pay", // collect | pay
   // Attributes shared with the platform, when a customer initiates a payment from a payer PSP
   "refId": "SU01ARZ3NDEKTSV4RRFFQ69G5FAV", // tr field in the intent
   "rrn": "124068997913",
   "txnNote": "testpay",
   "amount": 1000,
   "currency": "INR",
   "merchantVpa": "deku20231030@pineaxis",
   "customerVpa": "test-auto-9xsabx8n8x@pineaxis",
   "customerAccountType": "SAVINGS", // SAVINGS, CREDIT,...
   //  TPV attributes
   “tpv”: {
      "sourceAccounts": [
         {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 1234",
            "accountName": "M*N* T*O*M*A*S",
         }
      ],
      "customerAccount": {},
   }
   // Reason
   "reason": {} // sample mentioned above
}`}
                  </CodeBlockWithCopy>
               </>
            ),
         },
         {
            key: "2",
            label: "Payment pending",
            content: (
               <>
                     <Text>This indicates that the payment is being processed by UMAP and is sent to the merchant in case of a deemed transaction. {" "}Note that, <strong>this is not a terminal status</strong>, and Setu will send other updated notifications for the same transaction.</Text>
                     <CodeBlockWithCopy language="json">
{`{
   // Event attributes
   "eventId": "01ARZ3NDEKTSV4RRFFQ69G5FAV", // Id of an event (unique for each event)
   "eventTs": "2023-09-04 12:08:20.202644 +0530 IST", // Timestamp associated with the event
   "eventType": "payment.pending",
   "resource": "payment",
   "status": "pending",
   // Payment context
   "productInstanceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "productInstanceType": "<type>", // collect | pay_single | pay_multi | pay_single_tpv | autopay
   // References
   "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "merchantReferenceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   // Payment references
   "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "txnId": "SETmBZkQOV0M7wyyP1V4PIFhRSzW5eSjmYI",
   // mandate reference (in case of mandate related payment)
   "umn": "c27f5fc30d344e9594fce0afa34f8859@mypsp",
   // Payment attributes
   "txnType": "pay", // collect | pay
   // Attributes shared with the platform, when a customer initiates a payment from a payer PSP
   "refId": "SU01ARZ3NDEKTSV4RRFFQ69G5FAV", // tr field in the intent
   "rrn": "124068997913",
   "txnNote": "testpay",
   "amount": 1000,
   "currency": "INR",
   "merchantVpa": "deku20231030@pineaxis",
   "customerVpa": "test-auto-9xsabx8n8x@pineaxis",
   "customerAccountType": "SAVINGS", // SAVINGS, CREDIT,...
   //  TPV attributes
   “tpv”: {
      "sourceAccounts": [
         {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 1234",
            "accountName": "M*N* T*O*M*A*S",
         }
      ],
      "customerAccount": {
         "ifsc": "HDFC00123",
         "accountNumber": "**** **** **** 1234",
         "accountName": "M*N* T*O*M*A*S",
      },
   }
   // Reason
   "reason": {} // sample mentioned above
}`}
                     </CodeBlockWithCopy>
               </>
            ),
         },
         {
            key: "3",
            label: "Payment success",
            content: (
               <>
                     <Text>This is sent to the merchant once a payment has been successfully completed.</Text>
                     <CodeBlockWithCopy language="json">
{`{
   // Event attributes
   "eventId": "01ARZ3NDEKTSV4RRFFQ69G5FAV", // Id of an event (unique for each event)
   "eventTs": "2023-09-04 12:08:20.202644 +0530 IST", // Timestamp associated with the event
   "eventType": "payment.success",
   "resource": "payment",
   "status": "success",
   // Payment context
   "productInstanceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "productInstanceType": "<type>", // collect | pay_single | pay_multi | pay_single_tpv | autopay
   // References
   "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "merchantReferenceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   // Payment references
   "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "txnId": "SETmBZkQOV0M7wyyP1V4PIFhRSzW5eSjmYI",
   // mandate reference (in case of mandate related payment)
   "umn": "c27f5fc30d344e9594fce0afa34f8859@mypsp",
   // Payment attributes
   "txnType": "pay", // collect | pay
   // Attributes shared with the platform, when a customer initiates a payment from a payer PSP
   "refId": "SU01ARZ3NDEKTSV4RRFFQ69G5FAV", // tr field in the intent
   "rrn": "124068997913",
   "txnNote": "testpay",
   "amount": 1000,
   "currency": "INR",
   "merchantVpa": "deku20231030@pineaxis",
   "customerVpa": "test-auto-9xsabx8n8x@pineaxis",
   "customerAccountType": "SAVINGS", // SAVINGS, CREDIT,...
   //  TPV attributes
   “tpv”: {
      "sourceAccounts": [
         {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 1234",
            "accountName": "M*N* T*O*M*A*S",
         }
      ],
      "customerAccount": {
         "ifsc": "HDFC00123",
         "accountNumber": "**** **** **** 1234",
         "accountName": "M*N* T*O*M*A*S",
      },
   }
   // Reason
   "reason": {} // sample mentioned above
}`}
                     </CodeBlockWithCopy>
               </>
            ),
         },
         {
            key: "4",
            label: "Payment failed",
            content: (
               <>
                     <Text>This is sent to the merchant if a payment could not be processed and has been marked as failed.</Text>
                     <CodeBlockWithCopy language="json">
{`{
   // Event attributes
   "eventId": "01ARZ3NDEKTSV4RRFFQ69G5FAV", // Id of an event (unique for each event)
   "eventTs": "2023-09-04 12:08:20.202644 +0530 IST", // Timestamp associated with the event
   "eventType": "payment.failed",
   "resource": "payment",
   "status": "failed",
   // Payment context
   "productInstanceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "productInstanceType": "<type>", // collect | pay_single | pay_multi | pay_single_tpv | autopay
   // References
   "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "merchantReferenceId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   // Payment references
   "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
   "txnId": "SETmBZkQOV0M7wyyP1V4PIFhRSzW5eSjmYI",
   // mandate reference (in case of mandate related payment)
   "umn": "c27f5fc30d344e9594fce0afa34f8859@mypsp",
   // Payment attributes
   "txnType": "pay", // collect | pay
   // Attributes shared with the platform, when a customer initiates a payment from a payer PSP
   "refId": "SU01ARZ3NDEKTSV4RRFFQ69G5FAV", // tr field in the intent
   "rrn": "124068997913",
   "txnNote": "testpay",
   "amount": 1000,
   "currency": "INR",
   "merchantVpa": "deku20231030@pineaxis",
   "customerVpa": "test-auto-9xsabx8n8x@pineaxis",
   "customerAccountType": "SAVINGS", // SAVINGS, CREDIT,...
   //  TPV attributes
   “tpv”: {
      "sourceAccounts": [
         {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 1234",
            "accountName": "M*N* T*O*M*A*S",
         }
      ],
      "customerAccount": {
            "ifsc": "HDFC00123",
            "accountNumber": "**** **** **** 3456",
            "accountName": "S*A* N*O*T*A*L",
         },
   }
   // Reason
   "reason": {} // sample mentioned above
}`}
                     </CodeBlockWithCopy>
               </>
            ),
         },
   ]}
/>